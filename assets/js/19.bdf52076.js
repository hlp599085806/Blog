(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{580:function(t,s,a){"use strict";a.r(s);var r=a(17),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h3",{attrs:{id:"单页面应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单页面应用"}},[t._v("#")]),t._v(" 单页面应用")]),t._v(" "),a("p",[t._v("众所周知，用 React 或者 Vue 构建的应用都是单页面应用，单页面应用是使用一个 html\n前提下，一次性加载 js ， css\n等资源，所有页面都在一个容器页面下，页面切换实质是组件的切换。")]),t._v(" "),a("img",{staticStyle:{zoom:"33%"},attrs:{src:"http://rezpusy5t.hn-bkt.clouddn.com/547c044c45ea85c9ad0c4d7130a0869f.png",alt:"547c044c45ea85c9ad0c4d7130a0869f"}}),t._v(" "),a("h3",{attrs:{id:"路由原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由原理"}},[t._v("#")]),t._v(" 路由原理")]),t._v(" "),a("h4",{attrs:{id:"_1-history-react-router-react-router-dom-三者关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-history-react-router-react-router-dom-三者关系"}},[t._v("#")]),t._v(" 1 history ,React-router , React-router-dom 三者关系")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"http://rezpusy5t.hn-bkt.clouddn.com/5bce4a488a0eb390264d642e04f2ba97.png",alt:"5bce4a488a0eb390264d642e04f2ba97"}}),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("history：\nhistory是整个React-router的核心，里面包括两种模式的路由下改变路由的方法，和监听路由变化的方法。")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("react-router：\n有了history路由监听/改变的核心，那么就需要调度组件负责派发这些路由的更新，也需要容器组件通过路由更新，以此来渲染视图，所以增加了Router、Switch、Route等组件来处理视图渲染。")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("react-router-dom：再react-router的基础上新增了一个UI的拓展比如Link、NavLink。以及两种模式的根部路由")])])])]),t._v(" "),a("h4",{attrs:{id:"_2-两种路由主要方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-两种路由主要方式"}},[t._v("#")]),t._v(" 2 两种路由主要方式")]),t._v(" "),a("p",[t._v("路由主要分为两种方式，一种是history模式，另一种是Hash模式，History库对待两种模式的监听和处理方法不同。")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("history 模式下：http://www.xxx.com/home")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("hash 模式下：")]),a("a",{attrs:{href:"http://www.xxx.com/#/home",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("http://www.xxx.com/#/home")]),a("OutboundLink")],1)])])]),t._v(" "),a("p",[t._v("开发者如何运用这两种模式的路由呢，直接从react-router-dom中引用即可。")]),t._v(" "),a("ul",[a("li",[t._v("开启history模式")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" BrowserRouter "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Router "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react-router-dom'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("BrowserRouter\\"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\* ...开启history模式 \\*")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("BrowserRouter\\"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("开启Hash模式")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" HashRouter "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Router "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react-router-dom'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 和history一样")]),t._v("\n")])])]),a("p",[t._v("对应内部是如何开启两种模式，是根据history提供的两种方法，createBrowserHistory\n或者createHashHistory，两个方法创建出两种不同的history对象。源码中是这样展现的：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// react-router-dom/modules/BrowserRouter.js ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createBrowserHistory ascreateHistory "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"history"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BrowserRouter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Component")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     history "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createBrowserHistory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n     "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Router\n       history"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("history"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//通过createBrowserHistory方法来创建history对象来注入到Router组件中")]),t._v("\n")])])]),a("h4",{attrs:{id:"_3-react路由原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-react路由原理"}},[t._v("#")]),t._v(" 3 React路由原理")]),t._v(" "),a("p",[t._v("history对象是整个路由的核心原理，里面包含了监听路由，改变路由的方法，两种模式下的处理有些不同，但区别不大。")]),t._v(" "),a("p",[a("strong",[t._v("BrowserHistory模式下")])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("改变路由")])])]),t._v(" "),a("p",[t._v("指的是通过api实现路由跳转，我们常在React用应用的history.push去改变路由，实际上调用的是window.history.pushState方法")]),t._v(" "),a("p",[a("strong",[t._v("window.history.pushState")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("history"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("1.state:一个与指定网址相关的状态对象，popstate事件触发后，该对象会传入回调函数，如果不需要可以传入null")]),t._v(" "),a("p",[t._v("2.title:新页面的标题，但是如果浏览器页签目前都忽略这个值，也可以填入null")]),t._v(" "),a("p",[t._v("3.path:新的网址， 必须与当前页面处于一个域，浏览器的地址栏将显示这个地址。")]),t._v(" "),a("p",[a("strong",[t._v("window.history.replaceState")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("history"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replaceState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 参数内容同上")]),t._v("\n")])])]),a("p",[a("strong",[t._v("replaceState")]),t._v("方法会修改当前的history对象记录，但是"),a("strong",[t._v("history.length")]),t._v("的长度不会发生改变。")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("监听路由popstate")])])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'popstate'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\* 监听改变 \\*")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("同一个文档的 history 对象出现变化时，就会触发 popstate 事件， history.pushState\n可以使浏览器地址改变，但是无需刷新页面。注意⚠️的是：用")]),t._v(" "),a("p",[a("strong",[t._v("history.pushState()")]),t._v(" 或者 "),a("strong",[t._v("history.replaceState()")]),t._v(" 不会触发 "),a("strong",[t._v("popstate")]),t._v("\n事件。 "),a("strong",[t._v("popstate")]),t._v(" 事件只会在浏览器某些行为下触发,\n比如点击后退、前进按钮或者调用\n**history.back()、history.forward()、history.go()**方法。")]),t._v(" "),a("p",[a("strong",[t._v("HashHistory模式下")])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("改变路由")])])]),t._v(" "),a("p",[a("strong",[t._v("window.location.hash")])]),t._v(" "),a("p",[t._v("通过window.location.hash来获取和设置hash值，我们在哈希路由模式下，切换路由，本质上是改变的window.location.hash")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("监听路由")])])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("onhashchangewindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hashchange'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\*  监听改变 \\*")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 哈希路由模式下，监听路由变化使用的是hashchange")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);